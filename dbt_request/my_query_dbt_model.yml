version: 3
models:
  - name: my_query
    description: In this table we define our customer metrics. This documentation has been autogenerated by Scribe: www.scribedata.app
    columns:
      - name: customer_id
        description: This statement pulls from the id column in the ANALYTICS.PRODUCTION.CUSTOMERS table
        tests:
          - unique
          - not_null
      - name: customer_status
        description: This code is using a CASE statement to create a new column called customer_status that contains the value 'active' if count_of_unique_order_ids > 0 and 'inactive' otherwise.
        tests:
          - unique
          - not_null
      - name: last_delivery_date
        description: This statement pulls from the last_delivery_date column in the CUSTOMER_LAST_90_DAY_PURCHASES table
        tests:
          - unique
          - not_null
      - name: total_order_revenue
        description: This statement pulls from the total_order_revenue column in the CUSTOMER_LAST_90_DAY_PURCHASES table
        tests:
          - unique
          - not_null
      - name: days_between_first_and_last_order
        description: This code is calculating the number of days between the first and last order for each customer.
        tests:
          - unique
          - not_null
      - name: customer_revenue_rank
        description: This code is doing a ranking of the customers based on their total revenue. The code is using window functions to do this.
        tests:
          - unique
          - not_null
